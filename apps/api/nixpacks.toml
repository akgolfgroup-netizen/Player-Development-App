# Nixpacks configuration for IUP Golf API
# Handles native modules (argon2, prisma) properly

[phases.setup]
nixPkgs = ["nodejs_20", "python3", "gcc", "openssl"]

[phases.install]
cmds = ["npm ci"]

[phases.build]
cmds = ["npx prisma generate", "npm run build"]

[start]
cmd = "npx prisma migrate deploy && node dist/server.js"
